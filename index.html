<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Financial Planning Suite</title>
  <style>
    /* Basic Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5;
      color: #333;
      background-color: #f5f5f5;
      transition: background-color 0.3s, color 0.3s;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 2rem;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    .title {
      font-size: 2rem;
      font-weight: bold;
    }
    .subtitle {
      font-size: 1rem;
      color: #666;
      margin-bottom: 1rem;
    }
    /* Navigation */
    .nav {
      display: flex;
      gap: 1rem;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      padding: 0.5rem;
      margin-bottom: 2rem;
    }
    .nav-item {
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 4px;
      font-weight: 500;
    }
    .nav-item:hover {
      background-color: #f0f0f0;
    }
    .nav-item.active {
      background-color: #e9ecef;
    }
    /* Page layout */
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
    /* Theme controls */
    .theme-controls {
      position: fixed;
      top: 1rem;
      left: 1rem;
      display: flex;
      gap: 0.5rem;
      z-index: 100;
    }
    .theme-toggle {
      background: #333;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .theme-selector {
      position: relative;
    }
    .theme-button {
      background: #333;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .theme-dropdown {
      position: absolute;
      top: 45px;
      left: 0;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
      padding: 0.5rem;
      width: 150px;
      display: none;
      z-index: 10;
    }
    .theme-dropdown.show {
      display: block;
    }
    .theme-option {
      display: flex;
      align-items: center;
      padding: 0.5rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.2s;
    }
    .theme-option:hover {
      background-color: #f8f9fa;
    }
    .color-preview {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 0.5rem;
      border: 1px solid #ddd;
    }
    /* Card layout */
    .card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
      margin-bottom: 1.5rem;
      overflow: hidden;
      transition: background-color 0.3s;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f8f9fa;
      padding: 1rem;
      border-bottom: 1px solid #eee;
      font-weight: 600;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .card-body {
      padding: 1.5rem;
    }
    /* Basic calculator styles */
    .calculator-container {
      max-width: 360px;
      margin: 0 auto;
    }
    .display {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      font-size: 1.5rem;
      text-align: right;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #fff;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    .calculator-loader {
      display: none;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(0, 0, 0, 0.1);
      border-top-color: #3498db;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.5rem;
    }
    .btn {
      padding: 0.75rem;
      border: none;
      border-radius: 4px;
      background-color: #f8f9fa;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.2s, color 0.3s;
    }
    .btn:hover {
      background-color: #e9ecef;
    }
    .btn-outline {
      border: 1px solid #ddd;
      transition: border-color 0.3s;
    }
    .btn-primary {
      background-color: #1a73e8;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1765cc;
    }
    .btn-secondary {
      background-color: #e9ecef;
      font-weight: bold;
    }
    .btn-span-2 {
      grid-column: span 2;
    }
    /* Interest calculator styles */
    .interest-calculator {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }
    @media (max-width: 768px) {
      .interest-calculator {
        grid-template-columns: 1fr;
      }
    }
    .form-group {
      margin-bottom: 1rem;
    }
    .form-label {
      display: block;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }
    .form-input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #fff;
      transition: border-color 0.3s, background-color 0.3s;
    }
    .form-input:focus {
      border-color: #1a73e8;
      outline: none;
    }
    .results-section {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 1.5rem;
      transition: background-color 0.3s;
    }
    .result-card {
      background-color: white;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    .result-value {
      font-size: 1.5rem;
      font-weight: 700;
    }
    .result-label {
      color: #666;
      font-size: 0.875rem;
    }
    /* Chart styles */
    .chart-container {
      margin-top: 2rem;
      height: 300px;
      position: relative;
    }
    .chart-legend {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 1rem;
    }
    .legend-item {
      display: flex;
      align-items: center;
      font-size: 0.875rem;
    }
    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 0.5rem;
    }
    /* Chat styles */
    .chat-container {
      display: flex;
      flex-direction: column;
      height: 500px;
    }
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      background-color: #f5f5f5;
      border-radius: 8px;
      margin-bottom: 1rem;
      transition: background-color 0.3s;
    }
    .message {
      margin-bottom: 1rem;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      max-width: 80%;
      animation: fade-in 0.3s ease-in-out;
    }
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .message-user {
      background-color: #1a73e8;
      color: white;
      align-self: flex-end;
      margin-left: auto;
    }
    .message-bot {
      background-color: white;
      align-self: flex-start;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .chat-input-container {
      display: flex;
      gap: 0.5rem;
    }
    .chat-input {
      flex: 1;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      transition: border-color 0.3s, background-color 0.3s;
    }
    .chat-input:focus {
      border-color: #1a73e8;
      outline: none;
    }
    .send-button {
      padding: 0.75rem 1.5rem;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .send-button:hover {
      background-color: #1765cc;
    }
    .api-key-setup {
      text-align: center;
      padding: 2rem;
      background-color: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 1rem;
      transition: background-color 0.3s;
    }
    .api-key-input {
      width: 100%;
      max-width: 400px;
      margin: 1rem auto;
    }
    /* Enhanced theme variables */
    :root {
      --theme-hue: 210;
      --theme-saturation: 100%;
      --theme-lightness-base: 50%;
      --primary: var(--theme-hue) var(--theme-saturation) var(--theme-lightness-base);
      --accent-1: var(--theme-hue) var(--theme-saturation) calc(var(--theme-lightness-base) - 10%);
      --accent-2: var(--theme-hue) var(--theme-saturation) calc(var(--theme-lightness-base) - 20%);
      --accent-3: var(--theme-hue) var(--theme-saturation) calc(var(--theme-lightness-base) - 30%);
    }
    /* Navigation tabs */
    .nav-item.active, 
    .nav-item:hover {
      color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base));
    }
    /* Calculator Buttons */
    .calculator-key {
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.3)) !important;
      transition: background-color 0.2s ease;
      color: #000 !important; /* Black text for better readability */
      font-weight: 500;
      font-size: 1.1rem;
    }
    .calculator-key:hover {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base)) !important;
      color: #fff !important;
    }
    .calculator-operator-key {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base)) !important;
      color: white !important;
      font-weight: 600;
      font-size: 1.2rem;
    }
    .calculator-operator-key:hover {
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.9), calc(var(--theme-lightness-base) * 0.9)) !important;
    }
    /* Result Cards */
    .results-card {
      border: 1px solid hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.5), calc(var(--theme-lightness-base) * 1.5));
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.1), 98%);
    }
    .dark .results-card {
      border: 1px solid hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 0.8));
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.3), 15%);
    }
    /* Results sections */
    .results-heading {
      color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) * 0.8));
    }
    .dark .results-heading {
      color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) * 1.1));
    }
    .value-highlight {
      color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) * 0.9));
      font-weight: bold;
    }
    .dark .value-highlight {
      color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) * 1.2));
    }
    /* Input fields focus */
    input:focus, 
    select:focus,
    textarea:focus {
      border-color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base));
      box-shadow: 0 0 0 1px hsla(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base), 0.5);
    }
    /* Chart Colors */
    .chart-balance {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base));
    }
    
    .chart-contributions {
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1));
    }
    
    .chart-interest {
      background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8));
    }
    /* Dark theme styles */
    .dark {
      background-color: #121212;
      color: #e0e0e0;
    }
    .dark .card {
      background-color: #1e1e1e;
    }
    .dark .card-header {
      background-color: #2a2a2a;
      border-bottom-color: #333;
    }
    .dark .nav {
      background-color: #1e1e1e;
    }
    .dark .nav-item:hover {
      background-color: #2a2a2a;
    }
    .dark .nav-item.active {
      background-color: #333;
    }
    .dark .btn {
      background-color: #333;
      color: #e0e0e0;
    }
    .dark .btn:hover {
      background-color: #444;
    }
    .dark .btn-outline {
      border-color: #444;
    }
    .dark .calculator-key {
      color: #fff !important; /* White text in dark mode for better readability */
    }
    .dark .calculator-key:hover {
      color: #fff !important;
    }
    .dark .btn-primary {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) - 5%));
    }
    .dark .btn-primary:hover {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) - 10%));
    }
    .dark .form-input,
    .dark .chat-input,
    .dark .display {
      background-color: #333;
      color: #e0e0e0;
      border-color: #444;
    }
    .dark .chat-messages {
      background-color: #121212;
    }
    .dark .message-bot {
      background-color: #2a2a2a;
      color: #e0e0e0;
    }
    .dark .subtitle,
    .dark .form-label {
      color: #aaa;
    }
    .dark .theme-dropdown {
      background-color: #1e1e1e;
      color: #e0e0e0;
    }
    .dark .theme-option:hover {
      background-color: #2a2a2a;
    }
    .dark .api-key-setup {
      background-color: #1e1e1e;
    }
    .dark .message-user {
      background-color: hsl(var(--theme-hue), var(--theme-saturation), calc(var(--theme-lightness-base) - 5%));
    }
    /* Blue theme */
    .blue-theme {
      --theme-hue: 210;
      --theme-saturation: 100%;
      --theme-lightness-base: 50%;
    }
    /* Green theme */
    .green-theme {
      --theme-hue: 120;
      --theme-saturation: 60%;
      --theme-lightness-base: 40%;
    }
    /* Purple theme */
    .purple-theme {
      --theme-hue: 270;
      --theme-saturation: 70%;
      --theme-lightness-base: 45%;
    }
    /* Orange theme */
    .orange-theme {
      --theme-hue: 30;
      --theme-saturation: 90%;
      --theme-lightness-base: 50%;
    }
    /* Red theme */
    .red-theme {
      --theme-hue: 0;
      --theme-saturation: 80%;
      --theme-lightness-base: 50%;
    }
    /* Teal theme */
    .teal-theme {
      --theme-hue: 180;
      --theme-saturation: 70%;
      --theme-lightness-base: 40%;
    }
    /* Yellow theme */
    .yellow-theme {
      --theme-hue: 45;
      --theme-saturation: 90%;
      --theme-lightness-base: 60%;
    }
    /* Text center helper class */
    .text-center {
      text-align: center;
    }
    /* Margin helpers */
    .mb-6 {
      margin-bottom: 1.5rem;
    }
    .mb-8 {
      margin-bottom: 2rem;
    }
    .mx-auto {
      margin-left: auto;
      margin-right: auto;
    }
    /* Width helpers */
    .max-w-2xl {
      max-width: 42rem;
    }
    /* Display helpers */
    .grid {
      display: grid;
    }
    .grid-cols-1 {
      grid-template-columns: repeat(1, minmax(0, 1fr));
    }
    .grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
    .gap-6 {
      gap: 1.5rem;
    }
    .gap-8 {
      gap: 2rem;
    }
    @media (min-width: 768px) {
      .md\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (min-width: 1024px) {
      .lg\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    .space-y-1 > * + * {
      margin-top: 0.25rem;
    }
    .w-full {
      width: 100%;
    }
    .mt-4 {
      margin-top: 1rem;
    }
    .font-semibold {
      font-weight: 600;
    }
    .mb-2 {
      margin-bottom: 0.5rem;
    }
    .mb-4 {
      margin-bottom: 1rem;
    }
    .text-xl {
      font-size: 1.25rem;
      line-height: 1.75rem;
    }
    .text-gray-500 {
      color: #6b7280;
    }
    .p-4 {
      padding: 1rem;
    }
    .rounded-lg {
      border-radius: 0.5rem;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="theme-controls">
    <button id="theme-toggle" class="theme-toggle">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
    </button>
    <div class="theme-selector">
      <button id="theme-button" class="theme-button">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M12 8v8"></path>
          <path d="M8 12h8"></path>
        </svg>
      </button>
      <div id="theme-dropdown" class="theme-dropdown">
        <div class="theme-option" data-theme="default">
          <div class="color-preview" style="background-color: #1a73e8;"></div>
          <span>Default</span>
        </div>
        <div class="theme-option" data-theme="blue-theme">
          <div class="color-preview" style="background-color: #1976d2;"></div>
          <span>Blue</span>
        </div>
        <div class="theme-option" data-theme="green-theme">
          <div class="color-preview" style="background-color: #388e3c;"></div>
          <span>Green</span>
        </div>
        <div class="theme-option" data-theme="purple-theme">
          <div class="color-preview" style="background-color: #8e24aa;"></div>
          <span>Purple</span>
        </div>
        <div class="theme-option" data-theme="orange-theme">
          <div class="color-preview" style="background-color: #f57c00;"></div>
          <span>Orange</span>
        </div>
        <div class="theme-option" data-theme="red-theme">
          <div class="color-preview" style="background-color: #d32f2f;"></div>
          <span>Red</span>
        </div>
        <div class="theme-option" data-theme="teal-theme">
          <div class="color-preview" style="background-color: #00897b;"></div>
          <span>Teal</span>
        </div>
        <div class="theme-option" data-theme="yellow-theme">
          <div class="color-preview" style="background-color: #fbc02d;"></div>
          <span>Yellow</span>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="header">
      <div>
        <h1 class="title">Financial Planning Suite</h1>
        <p class="subtitle">Tools for financial growth and planning</p>
      </div>
    </div>
    <div class="nav">
      <div class="nav-item active" data-page="basic-calculator">Basic Calculator</div>
      <div class="nav-item" data-page="interest-calculator">Interest Calculator</div>
      <div class="nav-item" data-page="chat">Chat with Tom</div>
      <div class="nav-item" data-page="goal-recommendations">Goal Recommendations</div>
    </div>
    <!-- Basic Calculator -->
    <div id="basic-calculator" class="page active">
      <h2 class="text-center mb-6">Basic Calculator</h2>
      <p class="text-center mb-8 mx-auto max-w-2xl">
        Perform quick calculations with this easy-to-use calculator.
        Use your keyboard for faster input!
      </p>
      <div class="calculator-container">
        <div class="card">
          <div class="card-header">
            <span>Calculator</span>
            <div id="basic-calculator-loader" class="calculator-loader"></div>
          </div>
          <div class="card-body">
            <input type="text" id="display" class="display" readonly value="0">
            <div class="buttons">
              <!-- Memory operations -->
              <button class="btn btn-outline calculator-key" onclick="handleMemoryClear()">MC</button>
              <button class="btn btn-outline calculator-key" onclick="handleMemoryRecall()">MR</button>
              <button class="btn btn-outline calculator-key" onclick="handleMemoryAdd()">M+</button>
              <button class="btn btn-outline calculator-key" onclick="handleMemorySubtract()">M-</button>
              <!-- Clear, sign, percent, divide -->
              <button class="btn btn-outline calculator-key" onclick="clearAll()">C</button>
              <button class="btn btn-outline calculator-key" onclick="toggleSign()">+/-</button>
              <button class="btn btn-outline calculator-key" onclick="inputPercent()">%</button>
              <button class="btn calculator-operator-key" onclick="performOperation('÷')">÷</button>
              <!-- Digits 7-9 and multiply -->
              <button class="btn calculator-key" onclick="inputDigit('7')">7</button>
              <button class="btn calculator-key" onclick="inputDigit('8')">8</button>
              <button class="btn calculator-key" onclick="inputDigit('9')">9</button>
              <button class="btn calculator-operator-key" onclick="performOperation('×')">×</button>
              <!-- Digits 4-6 and subtract -->
              <button class="btn calculator-key" onclick="inputDigit('4')">4</button>
              <button class="btn calculator-key" onclick="inputDigit('5')">5</button>
              <button class="btn calculator-key" onclick="inputDigit('6')">6</button>
              <button class="btn calculator-operator-key" onclick="performOperation('-')">-</button>
              <!-- Digits 1-3 and add -->
              <button class="btn calculator-key" onclick="inputDigit('1')">1</button>
              <button class="btn calculator-key" onclick="inputDigit('2')">2</button>
              <button class="btn calculator-key" onclick="inputDigit('3')">3</button>
              <button class="btn calculator-operator-key" onclick="performOperation('+')">+</button>
              <!-- Zero, decimal, equals -->
              <button class="btn btn-span-2 calculator-key" onclick="inputDigit('0')">0</button>
              <button class="btn calculator-key" onclick="inputDecimal()">.</button>
              <button class="btn calculator-operator-key" onclick="performOperation('=')">=</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Interest Calculator -->
    <div id="interest-calculator" class="page">
      <h2 class="text-center mb-6">Compound Interest Calculator</h2>
      <p class="text-center mb-8 mx-auto max-w-2xl">
        Discover how your savings can grow over time with the power of compound interest.
      </p>
      <div class="interest-calculator">
        <div class="card results-card">
          <div class="card-body">
            <h3 class="text-xl font-semibold mb-4 results-heading">Input Parameters</h3>
            <form id="interest-form">
              <div class="form-group">
                <label for="initial-balance" class="form-label">Initial Balance ($)</label>
                <input type="number" id="initial-balance" class="form-input" min="0" value="10000">
              </div>
              <div class="form-group">
                <label for="weekly-contribution" class="form-label">Weekly Contribution ($)</label>
                <input type="number" id="weekly-contribution" class="form-input" min="0" value="200">
              </div>
              <div class="form-group">
                <label for="interest-rate" class="form-label">Annual Interest Rate (%)</label>
                <input type="number" id="interest-rate" class="form-input" min="0" step="0.1" value="5">
              </div>
              <div class="form-group">
                <label for="goal-amount" class="form-label">Goal Amount ($)</label>
                <input type="number" id="goal-amount" class="form-input" min="0" value="100000">
              </div>
            </form>
          </div>
        </div>
        <div>
          <div class="card results-card">
            <div class="card-body">
              <h3 class="text-xl font-semibold mb-4 results-heading">Your Results</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="results-card p-4 rounded-lg">
                  <p class="result-label">Time to Reach Goal</p>
                  <p id="time-to-goal" class="result-value value-highlight">6.1 years</p>
                </div>
                <div class="results-card p-4 rounded-lg">
                  <p class="result-label">Total Contributions</p>
                  <p id="total-contributions" class="result-value value-highlight">$65,200</p>
                </div>
                <div class="results-card p-4 rounded-lg">
                  <p class="result-label">Interest Earned</p>
                  <p id="interest-earned" class="result-value value-highlight">$25,614</p>
                </div>
                <div class="results-card p-4 rounded-lg">
                  <p class="result-label">Final Balance</p>
                  <p id="final-balance" class="result-value value-highlight">$100,814</p>
                </div>
              </div>
            </div>
          </div>
          <div class="card results-card">
            <div class="card-body">
              <h3 class="text-xl font-semibold mb-4 results-heading">Growth Visualization</h3>
              <div class="chart-container">
                <canvas id="growth-chart"></canvas>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <span class="legend-color" style="background-color: hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base));"></span>
                  <span>Balance</span>
                </div>
                <div class="legend-item">
                  <span class="legend-color" style="background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1));"></span>
                  <span>Contributions</span>
                </div>
                <div class="legend-item">
                  <span class="legend-color" style="background-color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8));"></span>
                  <span>Interest</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Chat with Tom -->
    <div id="chat" class="page">
      <h2 class="text-center mb-6">Chat with Tom</h2>
      <p class="text-center mb-8 mx-auto max-w-2xl">
        Get personalized financial advice from Tom, your AI financial assistant.
      </p>
      <div id="api-key-setup" class="api-key-setup">
        <h3 class="text-xl font-semibold mb-2">OpenAI API Key Setup</h3>
        <p class="mb-4">To chat with Tom, you'll need to provide your OpenAI API key.</p>
        <div class="api-key-input">
          <input type="password" id="api-key-input" class="form-input" placeholder="Enter your OpenAI API key">
        </div>
        <button id="submit-api-key" class="btn btn-primary">Submit Key</button>
        <button id="skip-api-key" class="btn">Skip for Now</button>
      </div>
      <div id="chat-interface" style="display: none;">
        <div class="card results-card">
          <div class="card-body">
            <div class="chat-container">
              <div id="chat-messages" class="chat-messages">
                <div class="message message-bot">
                  <p>Hi there! I'm Tom, your financial assistant. How can I help you today?</p>
                </div>
              </div>
              <div class="chat-input-container">
                <input type="text" id="chat-input" class="chat-input" placeholder="Type your message...">
                <button id="send-message" class="send-button">Send</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Goal Recommendations -->
    <div id="goal-recommendations" class="page">
      <h2 class="text-center mb-6">Financial Goal Recommendations</h2>
      <p class="text-center mb-8 mx-auto max-w-2xl">
        Get personalized recommendations based on your financial situation.
      </p>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="card results-card">
          <div class="card-body">
            <h3 class="text-xl font-semibold mb-4 results-heading">Your Financial Information</h3>
            <form id="financial-form">
              <div class="form-group">
                <label for="monthly-income" class="form-label">Monthly Income ($)</label>
                <input type="number" id="monthly-income" class="form-input" min="0" value="4000">
              </div>
              <div class="form-group">
                <label for="monthly-expenses" class="form-label">Monthly Expenses ($)</label>
                <input type="number" id="monthly-expenses" class="form-input" min="0" value="3000">
              </div>
              <div class="form-group">
                <label for="total-savings" class="form-label">Total Savings ($)</label>
                <input type="number" id="total-savings" class="form-input" min="0" value="10000">
              </div>
              <div class="form-group">
                <label for="total-debt" class="form-label">Total Debt ($)</label>
                <input type="number" id="total-debt" class="form-input" min="0" value="20000">
              </div>
              <div class="form-group">
                <label for="monthly-debt-payments" class="form-label">Monthly Debt Payments ($)</label>
                <input type="number" id="monthly-debt-payments" class="form-input" min="0" value="500">
              </div>
              <div class="form-group">
                <label for="retirement-savings" class="form-label">Retirement Savings ($)</label>
                <input type="number" id="retirement-savings" class="form-input" min="0" value="30000">
              </div>
              <div class="form-group">
                <label for="age" class="form-label">Age</label>
                <input type="number" id="age" class="form-input" min="0" value="35">
              </div>
              <button type="button" id="generate-recommendations" class="btn btn-primary w-full mt-4">Generate Recommendations</button>
            </form>
          </div>
        </div>
        <div id="recommendations-container" class="card results-card">
          <div class="card-body">
            <h3 class="text-xl font-semibold mb-4 results-heading">Your Recommendations</h3>
            <div id="recommendations-content">
              <p class="text-center text-gray-500">Fill out your financial information and click Generate Recommendations to get personalized advice.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    // Theme management
    const themeToggle = document.getElementById('theme-toggle');
    const themeButton = document.getElementById('theme-button');
    const themeDropdown = document.getElementById('theme-dropdown');
    const themeOptions = document.querySelectorAll('.theme-option');
    let isDarkMode = false;
    let currentTheme = 'default';
    // Initialize theme from localStorage if available
    function initTheme() {
      const savedDarkMode = localStorage.getItem('darkMode') === 'true';
      const savedTheme = localStorage.getItem('theme') || 'default';
      
      if (savedDarkMode) {
        toggleDarkMode();
      }
      
      if (savedTheme !== 'default') {
        applyTheme(savedTheme);
      }
    }
    // Toggle dark mode
    function toggleDarkMode() {
      isDarkMode = !isDarkMode;
      document.body.classList.toggle('dark', isDarkMode);
      localStorage.setItem('darkMode', isDarkMode);
      
      // Update toggle icon
      themeToggle.innerHTML = isDarkMode 
        ? '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>'
        : '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>';
    }
    // Apply selected theme
    function applyTheme(theme) {
      // Remove previous theme
      if (currentTheme !== 'default') {
        document.body.classList.remove(currentTheme);
      }
      
      // Apply new theme if not default
      if (theme !== 'default') {
        document.body.classList.add(theme);
      }
      
      currentTheme = theme;
      localStorage.setItem('theme', theme);
      
      // Update the chart colors
      updateChartColors();
    }
    // Event listeners for theme controls
    themeToggle.addEventListener('click', toggleDarkMode);
    
    themeButton.addEventListener('click', () => {
      themeDropdown.classList.toggle('show');
    });
    
    themeOptions.forEach(option => {
      option.addEventListener('click', () => {
        const theme = option.getAttribute('data-theme');
        applyTheme(theme);
        themeDropdown.classList.remove('show');
      });
    });
    
    // Close dropdown when clicking elsewhere
    document.addEventListener('click', (e) => {
      if (!themeButton.contains(e.target) && !themeDropdown.contains(e.target)) {
        themeDropdown.classList.remove('show');
      }
    });
    // Navigation
    const navItems = document.querySelectorAll('.nav-item');
    const pages = document.querySelectorAll('.page');
    
    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const targetPage = item.getAttribute('data-page');
        
        // Update active nav item
        navItems.forEach(navItem => navItem.classList.remove('active'));
        item.classList.add('active');
        
        // Show the target page, hide others
        pages.forEach(page => {
          if (page.id === targetPage) {
            page.classList.add('active');
          } else {
            page.classList.remove('active');
          }
        });
      });
    });
    // Basic Calculator
    let display = document.getElementById('display');
    let previousValue = null;
    let operator = null;
    let waitingForOperand = false;
    let memory = 0;
    function showCalculationAnimation() {
      const loader = document.getElementById('basic-calculator-loader');
      loader.style.display = 'block';
      setTimeout(() => {
        loader.style.display = 'none';
      }, 300);
    }
    function inputDigit(digit) {
      if (waitingForOperand) {
        display.value = digit;
        waitingForOperand = false;
      } else {
        display.value = display.value === '0' ? digit : display.value + digit;
      }
    }
    function inputDecimal() {
      if (waitingForOperand) {
        display.value = '0.';
        waitingForOperand = false;
        return;
      }
      if (display.value.indexOf('.') === -1) {
        display.value += '.';
      }
    }
    function clearDisplay() {
      display.value = '0';
      waitingForOperand = false;
    }
    function clearAll() {
      display.value = '0';
      previousValue = null;
      operator = null;
      waitingForOperand = false;
    }
    function toggleSign() {
      const value = parseFloat(display.value);
      display.value = (-value).toString();
    }
    function inputPercent() {
      const value = parseFloat(display.value);
      display.value = (value / 100).toString();
    }
    function performOperation(nextOperator) {
      const inputValue = parseFloat(display.value);
      if (previousValue === null) {
        previousValue = display.value;
      } else if (operator) {
        const currentValue = parseFloat(previousValue);
        let newValue;
        showCalculationAnimation();
        
        switch (operator) {
          case '+':
            newValue = currentValue + inputValue;
            break;
          case '-':
            newValue = currentValue - inputValue;
            break;
          case '×':
            newValue = currentValue * inputValue;
            break;
          case '÷':
            newValue = currentValue / inputValue;
            break;
          default:
            newValue = inputValue;
        }
        previousValue = newValue.toString();
        display.value = newValue.toString();
      }
      waitingForOperand = true;
      operator = nextOperator;
    }
    function handleMemoryClear() {
      memory = 0;
    }
    function handleMemoryRecall() {
      display.value = memory.toString();
      waitingForOperand = false;
    }
    function handleMemoryAdd() {
      memory += parseFloat(display.value);
    }
    function handleMemorySubtract() {
      memory -= parseFloat(display.value);
    }
    // Add keyboard support
    document.addEventListener('keydown', (event) => {
      if (document.getElementById('basic-calculator').classList.contains('active')) {
        const key = event.key;
        
        // Prevent default behavior for calculator keys
        if (
          /^\d$/.test(key) || 
          key === '.' || 
          key === '+' || 
          key === '-' || 
          key === '*' || 
          key === '/' || 
          key === 'Enter' || 
          key === '=' || 
          key === 'Escape' || 
          key === 'Backspace'
        ) {
          event.preventDefault();
        }
        
        // Handle numeric keys and decimal
        if (/^\d$/.test(key)) {
          inputDigit(key);
        } else if (key === '.') {
          inputDecimal();
        }
        // Handle operators
        else if (key === '+') {
          performOperation('+');
        } else if (key === '-') {
          performOperation('-');
        } else if (key === '*') {
          performOperation('×');
        } else if (key === '/') {
          performOperation('÷');
        } else if (key === 'Enter' || key === '=') {
          performOperation('=');
        }
        // Handle clear
        else if (key === 'Escape') {
          clearAll();
        }
        // Handle backspace - remove last digit
        else if (key === 'Backspace') {
          if (display.value.length > 1) {
            display.value = display.value.slice(0, -1);
          } else {
            display.value = '0';
          }
        }
      }
    });
    // Interest Calculator
    let growthChart = null;
    // Format currency
    function formatCurrency(value) {
      return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      }).format(value);
    }
    // Calculate results
    function calculateInterest() {
      const initialBalance = parseFloat(document.getElementById('initial-balance').value) || 0;
      const weeklyContribution = parseFloat(document.getElementById('weekly-contribution').value) || 0;
      const interestRate = parseFloat(document.getElementById('interest-rate').value) || 0;
      const goalAmount = parseFloat(document.getElementById('goal-amount').value) || 0;
      
      // Validate inputs
      if (initialBalance < 0 || weeklyContribution < 0 || interestRate < 0 || goalAmount <= 0) {
        return;
      }
      
      // Calculate
      const annualInterestRate = interestRate / 100;
      const weeklyInterestRate = annualInterestRate / 52;
      
      let balance = initialBalance;
      let totalContributions = 0;
      let totalInterest = 0;
      let weeks = 0;
      const maxWeeks = 100 * 52; // Max 100 years
      
      const growthData = {
        labels: [],
        balanceData: [],
        contributionsData: [],
        interestData: []
      };
      
      // Track progress every year
      const yearlySnapshots = [];
      
      while (balance < goalAmount && weeks < maxWeeks) {
        // Add contribution
        balance += weeklyContribution;
        totalContributions += weeklyContribution;
        
        // Add interest
        const interestEarned = balance * weeklyInterestRate;
        balance += interestEarned;
        totalInterest += interestEarned;
        
        weeks++;
        
        // Record yearly data for the chart
        if (weeks % 52 === 0) {
          const year = weeks / 52;
          yearlySnapshots.push({
            year,
            balance,
            totalContributions,
            totalInterest
          });
          
          growthData.labels.push(`Year ${year}`);
          growthData.balanceData.push(balance);
          growthData.contributionsData.push(totalContributions);
          growthData.interestData.push(totalInterest);
        }
      }
      
      // Calculate results
      const years = Math.floor(weeks / 52);
      const remainingWeeks = weeks % 52;
      
      // Format and display results
      document.getElementById('time-to-goal').textContent = years + (remainingWeeks > 0 ? '.' + Math.round(remainingWeeks / 52 * 10) : '') + ' years';
      document.getElementById('total-contributions').textContent = formatCurrency(totalContributions);
      document.getElementById('interest-earned').textContent = formatCurrency(totalInterest);
      document.getElementById('final-balance').textContent = formatCurrency(balance);
      
      // Update chart
      updateChart(growthData);
    }
    // Update chart
    function updateChart(data) {
      const ctx = document.getElementById('growth-chart').getContext('2d');
      
      if (growthChart) {
        growthChart.destroy();
      }
      
      // Generate colors based on theme variables
      const darkMode = document.body.classList.contains('dark');
      
      // Create a line gradient for Balance line
      const balanceLineColor = `hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base))`;
      
      // Create distinct shades for the chart elements
      const contributionsColor = `hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1))`;
      const interestColor = `hsl(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8))`;
      
      growthChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: data.labels,
          datasets: [
            {
              label: 'Balance',
              data: data.balanceData,
              backgroundColor: `hsla(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base), 0)`, // Transparent for line
              borderColor: balanceLineColor,
              borderWidth: 3,
              type: 'line',
              fill: false,
              tension: 0.4,
              yAxisID: 'y',
              pointBackgroundColor: balanceLineColor,
              pointBorderColor: balanceLineColor,
              pointHoverBackgroundColor: balanceLineColor,
              pointHoverBorderColor: '#fff',
              pointRadius: 4,
              pointHoverRadius: 6
            },
            {
              label: 'Contributions',
              data: data.contributionsData,
              backgroundColor: `hsla(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1), 0.7)`,
              borderColor: contributionsColor,
              borderWidth: 1,
              yAxisID: 'y'
            },
            {
              label: 'Interest',
              data: data.interestData,
              backgroundColor: `hsla(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8), 0.7)`,
              borderColor: interestColor,
              borderWidth: 1,
              yAxisID: 'y'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return '$' + value.toLocaleString();
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': $' + context.raw.toLocaleString();
                }
              }
            }
          }
        }
      });
    }
    function updateChartColors() {
      if (growthChart) {
        // Create a line gradient for Balance line
        const balanceLineColor = `hsl(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base))`;
        
        // Create distinct shades for the chart elements
        const contributionsColor = `hsl(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1))`;
        const interestColor = `hsl(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8))`;
        
        // Update Balance line (dataset 0)
        growthChart.data.datasets[0].backgroundColor = `hsla(var(--theme-hue), var(--theme-saturation), var(--theme-lightness-base), 0)`;
        growthChart.data.datasets[0].borderColor = balanceLineColor;
        growthChart.data.datasets[0].pointBackgroundColor = balanceLineColor;
        growthChart.data.datasets[0].pointBorderColor = balanceLineColor;
        growthChart.data.datasets[0].pointHoverBackgroundColor = balanceLineColor;
        
        // Update Contributions bars (dataset 1)
        growthChart.data.datasets[1].backgroundColor = `hsla(var(--theme-hue), calc(var(--theme-saturation) * 0.7), calc(var(--theme-lightness-base) * 1.1), 0.7)`;
        growthChart.data.datasets[1].borderColor = contributionsColor;
        
        // Update Interest bars (dataset 2)
        growthChart.data.datasets[2].backgroundColor = `hsla(var(--theme-hue), calc(var(--theme-saturation) * 1.2), calc(var(--theme-lightness-base) * 0.8), 0.7)`;
        growthChart.data.datasets[2].borderColor = interestColor;
        
        // Apply changes
        growthChart.update();
      }
    }
    // Listen for input changes
    const interestInputs = document.querySelectorAll('#interest-form input');
    interestInputs.forEach(input => {
      input.addEventListener('input', calculateInterest);
    });
    // Chat with Tom
    let apiKey = '';
    
    document.getElementById('submit-api-key').addEventListener('click', () => {
      const keyInput = document.getElementById('api-key-input');
      apiKey = keyInput.value.trim();
      
      if (apiKey) {
        document.getElementById('api-key-setup').style.display = 'none';
        document.getElementById('chat-interface').style.display = 'block';
      } else {
        alert('Please enter a valid API key');
      }
    });
    
    document.getElementById('skip-api-key').addEventListener('click', () => {
      document.getElementById('api-key-setup').style.display = 'none';
      document.getElementById('chat-interface').style.display = 'block';
      
      // Add a message about missing API key
      addBotMessage("I notice you haven't provided an API key. While I can still chat with you, my responses will be limited. To get the full AI experience, please provide your OpenAI API key.");
    });
    
    function addUserMessage(message) {
      const chatMessages = document.getElementById('chat-messages');
      const messageElement = document.createElement('div');
      messageElement.className = 'message message-user';
      messageElement.innerHTML = `<p>${message}</p>`;
      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function addBotMessage(message) {
      const chatMessages = document.getElementById('chat-messages');
      const messageElement = document.createElement('div');
      messageElement.className = 'message message-bot';
      messageElement.innerHTML = `<p>${message}</p>`;
      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function addTypingIndicator() {
      const chatMessages = document.getElementById('chat-messages');
      const typingElement = document.createElement('div');
      typingElement.className = 'message message-bot typing-indicator';
      typingElement.innerHTML = `<p>Tom is typing<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span></p>`;
      typingElement.id = 'typing-indicator';
      chatMessages.appendChild(typingElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function removeTypingIndicator() {
      const typingElement = document.getElementById('typing-indicator');
      if (typingElement) {
        typingElement.remove();
      }
    }
    
    async function sendMessageToTom(message) {
      if (!apiKey) {
        // Simple canned responses for demo without API key
        const responses = [
          "I'd love to help with that, but I need an API key to access my full capabilities. You can set it up anytime by refreshing and entering your OpenAI API key.",
          "That's an interesting financial question. To give you detailed advice, I'll need access to my AI features through an OpenAI API key.",
          "To properly analyze your financial situation, I need my full capabilities. Please consider setting up your API key.",
          "I'm designed to provide personalized financial advice, but I can only do that with my AI features enabled through an API key.",
          "I understand you're looking for financial guidance. For the best experience, please set up your API key so I can give you tailored advice."
        ];
        
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        
        // Simulate typing delay
        addTypingIndicator();
        await new Promise(resolve => setTimeout(resolve, 1500));
        removeTypingIndicator();
        addBotMessage(randomResponse);
        return;
      }
      
      try {
        addTypingIndicator();
        // This would normally be a fetch to your backend API
        // For this standalone version, we'll simulate a response delay
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Simulated response - in a real app, this would come from the OpenAI API
        let response = "I'm Tom, your financial assistant. I would normally connect to OpenAI's API to provide personalized financial advice. In this standalone demo, I'm providing a simulated response.";
        
        if (message.toLowerCase().includes("invest")) {
          response = "Investment is a great way to grow your wealth. I recommend starting with a diverse portfolio that includes a mix of stocks, bonds, and possibly real estate or index funds. The right mix depends on your age, risk tolerance, and financial goals.";
        } else if (message.toLowerCase().includes("save")) {
          response = "Saving is the foundation of financial security. Try to save at least 20% of your income, with three to six months of expenses in an emergency fund. After that, consider tax-advantaged retirement accounts like 401(k)s or IRAs.";
        } else if (message.toLowerCase().includes("debt")) {
          response = "When tackling debt, focus first on high-interest debt like credit cards. Consider the snowball method (paying smallest debts first) or the avalanche method (highest interest first). Remember, not all debt is bad - mortgage debt, for example, can be a tool for building wealth.";
        } else if (message.toLowerCase().includes("budget")) {
          response = "A good budget follows the 50/30/20 rule: 50% for needs, 30% for wants, and 20% for savings and debt repayment. Track your spending for a month to see where your money goes, then make adjustments to align with your financial goals.";
        }
        
        removeTypingIndicator();
        addBotMessage(response);
      } catch (error) {
        removeTypingIndicator();
        addBotMessage("I'm sorry, I encountered an error. Please check your API key or try again later.");
      }
    }
    
    document.getElementById('send-message').addEventListener('click', () => {
      const chatInput = document.getElementById('chat-input');
      const message = chatInput.value.trim();
      
      if (message) {
        addUserMessage(message);
        chatInput.value = '';
        sendMessageToTom(message);
      }
    });
    
    document.getElementById('chat-input').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const chatInput = document.getElementById('chat-input');
        const message = chatInput.value.trim();
        
        if (message) {
          addUserMessage(message);
          chatInput.value = '';
          sendMessageToTom(message);
        }
        
        e.preventDefault();
      }
    });
    // Goal Recommendations
    document.getElementById('generate-recommendations').addEventListener('click', () => {
      const monthlyIncome = parseFloat(document.getElementById('monthly-income').value) || 0;
      const monthlyExpenses = parseFloat(document.getElementById('monthly-expenses').value) || 0;
      const totalSavings = parseFloat(document.getElementById('total-savings').value) || 0;
      const totalDebt = parseFloat(document.getElementById('total-debt').value) || 0;
      const monthlyDebtPayments = parseFloat(document.getElementById('monthly-debt-payments').value) || 0;
      const retirementSavings = parseFloat(document.getElementById('retirement-savings').value) || 0;
      const age = parseInt(document.getElementById('age').value) || 0;
      
      // Calculate financial metrics
      const savingsRate = monthlyIncome > 0 ? ((monthlyIncome - monthlyExpenses) / monthlyIncome) * 100 : 0;
      const debtToIncomeRatio = monthlyIncome > 0 ? (monthlyDebtPayments / monthlyIncome) * 100 : 0;
      const emergencyFundMonths = monthlyExpenses > 0 ? totalSavings / monthlyExpenses : 0;
      
      // Get income category
      let incomeCategory = "moderate";
      if (monthlyIncome < 3000) incomeCategory = "low";
      if (monthlyIncome > 7000) incomeCategory = "high";
      
      // Generate recommendations
      let recommendations = `<div class="results-card p-4 rounded-lg mb-4">
        <h4 class="font-semibold mb-2 results-heading">Your Financial Overview</h4>
        <ul class="space-y-1">
          <li><strong class="value-highlight">Savings Rate:</strong> ${savingsRate.toFixed(1)}%</li>
          <li><strong class="value-highlight">Debt-to-Income Ratio:</strong> ${debtToIncomeRatio.toFixed(1)}%</li>
          <li><strong class="value-highlight">Emergency Fund:</strong> ${emergencyFundMonths.toFixed(1)} months</li>
        </ul>
      </div>`;
      
      // Emergency Fund Recommendation
      recommendations += `<div class="results-card p-4 rounded-lg mb-4">
        <h4 class="font-semibold mb-2 results-heading">Emergency Fund</h4>
        <p>${emergencyFundMonths < 3 ? 
          "Priority: Build your emergency fund to at least 3 months of expenses." : 
          emergencyFundMonths < 6 ? 
          "Good start: Consider growing your emergency fund to 6 months of expenses for better security." : 
          "Excellent: Your emergency fund is well-established. Maintain it and focus on other financial goals."}
        </p>
      </div>`;
      
      // Debt Management
      recommendations += `<div class="results-card p-4 rounded-lg mb-4">
        <h4 class="font-semibold mb-2 results-heading">Debt Management</h4>
        <p>${debtToIncomeRatio > 35 ? 
          "High priority: Your debt-to-income ratio is concerning. Focus on paying down high-interest debt first." : 
          debtToIncomeRatio > 20 ? 
          "Moderate concern: Work on reducing your debt to improve financial flexibility." : 
          "Good position: Your debt levels are manageable. Continue making regular payments while building wealth."}
        </p>
      </div>`;
      
      // Savings Goals
      recommendations += `<div class="results-card p-4 rounded-lg mb-4">
        <h4 class="font-semibold mb-2 results-heading">Savings Strategy</h4>
        <p>${savingsRate < 10 ? 
          "Improvement needed: Try to increase your savings rate to at least 15-20% of income." : 
          savingsRate < 20 ? 
          "Good foundation: You're saving at a healthy rate. Consider automating savings to reach your goals faster." : 
          "Excellent: Your high savings rate will accelerate your path to financial independence."}
        </p>
      </div>`;
      
      // Retirement Planning
      const retirementMultiplier = age < 30 ? 1 : age < 40 ? 2 : age < 50 ? 4 : age < 60 ? 6 : 8;
      const targetRetirement = monthlyIncome * 12 * retirementMultiplier;
      
      recommendations += `<div class="results-card p-4 rounded-lg mb-4">
        <h4 class="font-semibold mb-2 results-heading">Retirement Planning</h4>
        <p>${retirementSavings < targetRetirement * 0.5 ? 
          `Consider increasing retirement contributions. By your age, aim for about $${formatCurrency(targetRetirement)} in retirement savings.` : 
          retirementSavings < targetRetirement ? 
          `You're on track. Continue building toward $${formatCurrency(targetRetirement)} in retirement savings.` : 
          `Excellent retirement progress. You're ahead of many peers in your age group.`}
        </p>
      </div>`;
      
      // Housing/Investment
      recommendations += `<div class="results-card p-4 rounded-lg">
        <h4 class="font-semibold mb-2 results-heading">Investment Strategy</h4>
        <p>${incomeCategory === "low" ? 
          "Focus on building stability before aggressive investing. Consider index funds for long-term growth with minimal fees." : 
          incomeCategory === "moderate" ? 
          "Balance between retirement accounts, index funds, and potentially real estate if it aligns with your goals." : 
          "Consider tax-advantaged investing strategies, diversification across asset classes, and potentially working with a financial advisor."}
        </p>
      </div>`;
      
      // Update the recommendations container
      document.getElementById('recommendations-content').innerHTML = recommendations;
    });
    // Initialize the app
    initTheme();
    
    // Initialize calculators on page load
    calculateInterest();
    // Add any additional initialization as needed
  </script>
</body>
</html>
